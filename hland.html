<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width">
    <title></title>
    <link href="https://fonts.googleapis.com/css?family=Raleway:400,800" rel="stylesheet">
    <link href="css/app.css" rel="stylesheet">
    <style>
      #ss-banner {
          background: transparent url(https://github.com/hps/heartland-php/blob/master/examples/end-to-end/assets/images/ss-shield@2x.png?raw=true) no-repeat left center;
          height: 40px;
          background-size: 280px 34px;
          margin-bottom: 7px;
      }
      .heartland-field {
        font-family: sans-serif;
        box-sizing: border-box;
        display: block;
        height: 50px;
        padding: 6px 12px;
        font-size: 14px;
        line-height: 1.42857143;
        color: #555;
        background-color: #fff;
        border: 1px solid #ccc;
        border-radius: 0px;
        -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075);
        box-shadow: inset 0 1px 1px rgba(0,0,0,.075);
        -webkit-transition: border-color ease-in-out .15s,-webkit-box-shadow ease-in-out .15s;
        -o-transition: border-color ease-in-out .15s,box-shadow ease-in-out .15s;
        transition: border-color ease-in-out .15s,box-shadow ease-in-out .15s;
        width: 300px;
        margin: 3px 0 5px;
      }
    </style>
    <script type="text/javascript">
      if(!document.getElementById('hScript')){
        var script = document.createElement("script");
        script.id = "hScript";
        script.type = "text/javascript";
        script.src = 'https://api2.heartlandportico.com/SecureSubmit.v1/token/2.1/securesubmit.js';
        script.onload = function(){
          setTimeout(function(){
            initPayform();
          },1000);
        }
        document.head.appendChild(script);
      }
      var hObj = null;
      window.heartlandCss = {
          'input': {
            'background': '#fff',
            'border': '1px solid',
            'border-color': '#bbb3b9 #c7c1c6 #c7c1c6',
            'box-sizing': 'border-box',
            'font-family': 'serif',
            'font-size': '16px',
            'line-height': '1',
            'margin': '0 .5em 0 0',
            'max-width': '100%',
            'outline': '0',
            'padding': '0.5278em',
            'vertical-align': 'baseline',
            'height' : '50px',
            'width' : '100% !important'
          },
          '#heartland-field': {
            'font-family':'sans-serif',
            'box-sizing':'border-box',
            'display': 'block',
            'height': '50px',
            'padding': '6px 12px',
            'font-size': '14px',
            'line-height': '1.42857143',
            'color': '#555',
            'background-color': '#fff',
            'border': '1px solid #ccc',
            'border-radius': '0px',
            '-webkit-box-shadow': 'inset 0 1px 1px rgba(0,0,0,.075)',
            'box-shadow': 'inset 0 1px 1px rgba(0,0,0,.075)',
            '-webkit-transition': 'border-color ease-in-out .15s,-webkit-box-shadow ease-in-out .15s',
            '-o-transition': 'border-color ease-in-out .15s,box-shadow ease-in-out .15s',
            'transition': 'border-color ease-in-out .15s,box-shadow ease-in-out .15s',
            'width' : '100%'
          },  
          '#heartland-field[name=submit]': {   
            'background-color':'#36b46e',
            'font-family':'sans-serif',
            'text-transform':'uppercase',
            'color':'#ffffff',
            'border':'0px solid transparent'
          } ,
          '#heartland-field[name=submit]:focus': {   
            'color':'#ffffff',
            'background-color':'#258851',
            'outline':'none'
          } , 
          '#heartland-field[name=submit]:hover': {   
            'background-color':'#258851'
          } ,          
          '#heartland-field-wrapper #heartland-field:focus' : {
            'border':'1px solid #3989e3',
            'outline':'none',
            'box-shadow':'none',
            'height':'50px'
          },
          'heartland-field-wrapper #heartland-field' : {
            'height':'50px'
          },
          'input[type=submit]' : {
            'box-sizing':'border-box',
            'display': 'inline-block',
            'padding': '6px 12px',
            'margin-bottom': '0',
            'font-size': '14px',
            'font-weight': '400',
            'line-height': '1.42857143',
            'text-align': 'center',
            'white-space': 'nowrap',
            'vertical-align': 'middle',
            '-ms-touch-action': 'manipulation',
            'touch-action': 'manipulation',
            'cursor': 'pointer',
            '-webkit-user-select': 'none',
            '-moz-user-select': 'none',
            '-ms-user-select': 'none',
            'user-select': 'none',
            'background-image': 'none',
            'border': '1px solid transparent',
            'border-radius': '4px',
            'color': '#fff',
            'background-color': '#337ab7',
            'border-color': '#2e6da4'
          },
          '#heartland-field[placeholder]' :{
            'letter-spacing':'3px'
          },
          '#heartland-field[name=cardCvv]' :{
            'background':'transparent url(https://github.com/hps/heartland-php/blob/master/examples/end-to-end/assets/images/cvv1.png?raw=true) no-repeat right',
            'background-size' :'63px 40px',
          },
          'input#heartland-field[name=cardNumber]' : {
            'background':'transparent url(https://github.com/hps/heartland-php/blob/master/examples/end-to-end/assets/images/ss-inputcard-blank@2x.png?raw=true) no-repeat right',
            'background-size' :'55px 35px'},
          '#heartland-field.invalid.card-type-visa' :{
            'background':'transparent url(https://github.com/hps/heartland-php/blob/master/examples/end-to-end/assets/images/ss-saved-visa@2x.png?raw=true) no-repeat right',
            'background-size' :'83px 88px',
            'background-position-y':'-44px'
          },
          '#heartland-field.valid.card-type-visa' :{
            'background':'transparent url(https://github.com/hps/heartland-php/blob/master/examples/end-to-end/assets/images/ss-saved-visa@2x.png?raw=true) no-repeat right top',
            'background-size' :'82px 86px'
          },
          '#heartland-field.invalid.card-type-discover' :{
            'background':'transparent url(https://github.com/hps/heartland-php/blob/master/examples/end-to-end/assets/images/ss-saved-discover@2x.png?raw=true) no-repeat right',
            'background-size' :'85px 90px',
            'background-position-y' : '-44px'
          },
          '#heartland-field.valid.card-type-discover' :{
            'background':'transparent url(https://github.com/hps/heartland-php/blob/master/examples/end-to-end/assets/images/ss-saved-discover@2x.png?raw=true) no-repeat right',
            'background-size' :'85px 90px',
            'background-position-y' : '1px'
          },
          '#heartland-field.invalid.card-type-amex' :{
            'background':'transparent url(https://github.com/hps/heartland-php/blob/master/examples/end-to-end/assets/images/ss-savedcards-amex@2x.png?raw=true) no-repeat right',
            'background-size' :'50px 90px',
            'background-position-y':'-44px'
          },
          '#heartland-field.valid.card-type-amex' :{
            'background':'transparent url(https://github.com/hps/heartland-php/blob/master/examples/end-to-end/assets/images/ss-savedcards-amex@2x.png?raw=true) no-repeat right top',
            'background-size' :'50px 90px'
          },
          '#heartland-field.invalid.card-type-mastercard' :{
            'background':'transparent url(https://github.com/hps/heartland-php/blob/master/examples/end-to-end/assets/images/ss-saved-mastercard.png?raw=true) no-repeat right',
            'background-size' :'62px 105px',
            'background-position-y':'-52px'
          },
          '#heartland-field.valid.card-type-mastercard' :{
            'background':'transparent url(https://github.com/hps/heartland-php/blob/master/examples/end-to-end/assets/images/ss-saved-mastercard.png?raw=true) no-repeat right',
            'background-size' :'62px 105px',
            'background-position-y':'-1px'
          },
          '#heartland-field.invalid.card-type-jcb' :{
            'background':'transparent url(https://github.com/hps/heartland-php/blob/master/examples/end-to-end/assets/images/ss-saved-jcb@2x.png?raw=true) no-repeat right',
            'background-size' :'55px 94px',
            'background-position-y':'-44px'
          },
          '#heartland-field.valid.card-type-jcb' :{
            'background':'transparent url(https://github.com/hps/heartland-php/blob/master/examples/end-to-end/assets/images/ss-saved-jcb@2x.png?raw=true) no-repeat right top',
            'background-size' :'55px 94px',
            'background-position-y':'2px'
          },
          'input#heartland-field[name=cardNumber]::-ms-clear' : {
            'display':'none'
          }
        };
      var pkey = location.hash.split("=")[1];
      function initPayform(){
        hObj = new Heartland.HPS({
            publicKey: pkey,
            type: 'iframe',
            fields: {
                cardNumber: {
                    target: 'iframesCardNumber',
                    placeholder: '•••• •••• •••• ••••'
                },
                cardExpiration: {
                    target: 'iframesCardExpiration',
                    placeholder: 'MM / YYYY'
                },
                cardCvv: {
                    target: 'iframesCardCvv',
                    placeholder: 'CVV'
                },
                submit: {
                    value: 'Checkout',
                    target: 'process-heartland'
                }
            },
            style: window.heartlandCss,
            onTokenSuccess: function (resp) {
              console.log('S', resp);
              setTimeout(function(){
                resp.zip = document.querySelector("#iframesCardZip").value;
                location.href = "./thanks.html#t="+JSON.stringify(resp);
              },3000);
            },
            onTokenError: function (resp) {
                console.log('Heartland Error', resp);
                location.href = "./error.html#e="+resp.error.message;
                //$rootScope.heartlandError = resp.error.message;
            }
        });
      }
    </script>
  </head>
  <body >
    <div>
      <form type="post">
        <div id="ss-banner"></div>
        <div class="row">
          <div class="lab">Card Number</div>
          <div class="inp"><div type="text" id="iframesCardNumber"></div></div>
        </div>
        <div class="row">
          <div class="lab">Expiration</div>
          <div class="inp"><div type="text" id="iframesCardExpiration"></div></div>
        </div>
        <div class="row">
          <div class="lab">CVV</div>
          <div class="inp"><div type="text" id="iframesCardCvv"></div></div>
        </div>
        <div class="row">
          <div class="lab">Zipcode</div>
          <div class="inp"><input type="number" maxlength="8" id="iframesCardZip" class="heartland-field"></div>
        </div>
        <div class="row">
          <div class="inp"><div type="submit" id="process-heartland" value="Submit"></div></div>
        </div>
      </form>
    </div>
  </body>
</html>
